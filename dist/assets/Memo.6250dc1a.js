import{l as e,o as t,v as a,a as l,w as n,y as s,Q as o,R as i,S as c,q as r,c as u,T as d,U as v,m as p,V as g,W as f,G as h,H as m,A as w,X as y,p as x,k as C,s as k,n as L,K as b,t as _,L as A,Y as E,I as M,x as S,Z as H,_ as z,M as I,E as T}from"./vendor.d6a5c002.js";import{u as B,m as P,A as V}from"./article.94c76adf.js";import"./index.a64ad817.js";var q=e({name:"Check"});const D={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},U=l("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1);q.render=function(e,l,n,s,o,i){return t(),a("svg",D,[U])},q.__file="packages/components/Check.vue";var Y=q,j=e({name:"Edit"});const R={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},W=l("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640V512z"},null,-1),K=l("path",{fill:"currentColor",d:"m469.952 554.24 52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"},null,-1);j.render=function(e,l,n,s,o,i){return t(),a("svg",R,[W,K])},j.__file="packages/components/Edit.vue";var N=j,O=e({name:"Refresh"});const $={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},G=l("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"},null,-1);O.render=function(e,l,n,s,o,i){return t(),a("svg",$,[G])},O.__file="packages/components/Refresh.vue";var Q=O,X=e({name:"Search"});const Z={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},F=l("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1);X.render=function(e,l,n,s,o,i){return t(),a("svg",Z,[F])},X.__file="packages/components/Search.vue";var J=X;function ee(e){return Number(e.replace(/px$/,""))}function te(e,t){const a=e,l=B(),{tagList:u}=c(l),d=n(!1),{textareaContent:v,insertContent:p,computeSelectPos:g}=function(e){const t=n(""),a=n(e);return s(t,(()=>{a.value.style.height="auto",a.value.style.height=a.value.scrollHeight+"px"})),o(a,"input",(e=>{t.value=e.target.value})),{textareaContent:t,insertContent:e=>{const{selectionEnd:l}=a.value,n=l,s=t.value,o=s.slice(0,l)+e+s.slice(l);t.value=o,a.value.blur(),i((()=>{a.value.selectionEnd=n+e.length,a.value.focus()}))},computeSelectPos:()=>{const e=a.value,{offsetLeft:t,offsetTop:l,selectionEnd:n}=e,s=document.createElement("div"),o=window.getComputedStyle(e);let i="0px",c="0px";for(const a of Array.from(o)){const e=o.getPropertyValue(a);"width"===a&&(i=e),"height"===a&&(c=e),s.style.setProperty(a,e)}s.style.position="fixed",s.style.visibility="hidden",s.style.whiteSpace="pre-wrap",s.innerHTML=e.value.slice(0,n);const r=document.createElement("span");r.innerHTML=e.value.slice(n),s.appendChild(r),document.body.appendChild(s);const u=r.offsetLeft,d=r.offsetTop;return document.body.removeChild(s),{x:t+u,y:l+d,containerWidth:ee(i),containerHeight:ee(c)}}}}(t),f=n(!1);s(f,((e=!0)=>{if(!e)return;const{x:t,y:l,containerWidth:n,containerHeight:s}=g();let o=t+15+"px",i=l+22+"px";return n-ee(o)<150&&(o=`calc( ${o} + -50% )`),ee(i)>s&&(i=s+22+"px"),a.value.style.top=""+i,a.value.style.left=""+o,!1}));const h=u,m=(e=1)=>{const t=h.value,a=()=>{t.forEach((e=>{e.active=!1}))};if(1===e){const e=t.findIndex((e=>e.active));a();const l=e+1<t.length?e+1:0;t[l].active=!0}else{const e=t.findIndex((e=>e.active));a();t[e-1>0?e-1:0].active=!0}};o(t,"keydown",(e=>{const t=e.key;if(0!==r(u).length){if("#"===t)return f.value=!0,!1;if("Enter"==e.key&&e.ctrlKey&&(d.value=!0),f.value){if("Backspace"===t)return void(f.value=!1);if(["ArrowUp","Enter"," "].includes(t)&&(e.stopPropagation(),e.preventDefault()),"ArrowUp"===t?m(-1):"ArrowDown"===t&&m(1),"Enter"===t||" "===t){const e=h.value.find((e=>e.active));p(e.content+" "),f.value=!1}}}})),o(t,"input",(e=>{"#"===v.value.charAt(v.value.length-1)&&r(u).length&&(f.value=!0)}));return document.onclick=()=>{f.value=!1},{textareaContent:v,shouldSuggestionShow:f,itemClicked:e=>{const t=e.target.innerText;p(t+" ")},suggestionList:h,handleIconClick:e=>{if(e.preventDefault(),e.stopPropagation(),p("#"),0===u.value.length)return!1;f.value=!0}}}x("data-v-7a8bb1dd");const ae={class:"input-container"},le={class:"bar"},ne=["disabled"],se={class:"loading-box"};C();var oe=e({props:{tags:{type:Array,default:[]}},setup(e){const a=n(null),l=n(null),{textareaContent:o,shouldSuggestionShow:i,handleIconClick:c,itemClicked:x,suggestionList:C}=te(a,l),b=e=>{e.preventDefault(),e.stopPropagation(),A.value=!0,console.log(A.value),(()=>{const e={tags:_(o.value),content:o.value};console.log(e),(0,B().save)(e).then((e=>{A.value=!1,console.log(e),o.value=""}))})()};s(o,(()=>{}));const _=e=>Array.from(e.match(/#[^\s(?<!#)]+/g)||[]).map((e=>e.slice(1))),A=n(!1);return s(i,(e=>{console.log("shouldSuggestionShow:",e)})),(e,n)=>(t(),u("div",ae,[d(p("textarea",{"onUpdate:modelValue":n[0]||(n[0]=e=>g(o)?o.value=e:null),name:"text-input",ref:l},null,512),[[v,r(o)]]),d(p("div",{class:"suggestion",ref:a,onClick:n[1]||(n[1]=e=>r(x)(e))},[(t(!0),u(h,null,m(r(C),(e=>(t(),u("span",{class:k({active:e.active})},L(e.content),3)))),256))],512),[[f,r(i)]]),p("div",le,[p("span",{class:"tag-icon",onClick:n[2]||(n[2]=e=>r(c)(e))}," # "),p("button",{class:"save",onClick:n[3]||(n[3]=w((e=>b(e)),["prevent"])),disabled:r(y)(r(o))}," 发送 ",8,ne)]),d(p("div",se,"loading...",512),[[f,A.value]])]))}});oe.__scopeId="data-v-7a8bb1dd";x("data-v-4d998c92");const ie={class:"card"},ce={class:"header"},re={class:"time-text"},ue={class:"more"},de=p("svg",{"data-v-38588c71":"",width:"16px",height:"16px",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},[p("path",{"data-v-38588c71":"","fill-rule":"evenodd",d:"M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"})],-1),ve=[p("li",{"data-type":"get-link"},"复制链接",-1),p("li",{"data-type":"set-top"},"置顶",-1),p("li",{"data-type":"detail"},"查看详情",-1),p("li",{"data-type":"edit"},"编辑",-1),p("li",{"data-type":"delete"},"删除",-1)],pe={class:"content"},ge={class:"footer"},fe={class:"tag-view"},he=["onClick"];C();var me=e({props:{article:{type:Object,default:{}},isLast:{type:Boolean,default:!1}},setup(e){const a=e,n=B(),s=b();let{article:o}=_(a);const i=A((()=>{(void 0)(navigator.language);const e=(void 0)(o.value.updateTime).local();return e.diff(P(),"day")<0?e.format("YYYY-MM-DD HH:mm:ss"):e.fromNow()}));return(e,c)=>(t(),u("li",ie,[p("div",ce,[p("span",re,L(r(i)),1),p("div",ue,[l(r(E),{placement:a.isLast?"top":"bottom",trigger:"hover"},{reference:M((()=>[de])),default:M((()=>[p("ul",{onClick:c[0]||(c[0]=e=>(e=>{switch(e.target.dataset.type){case"delete":n.deleteArticle(+a.article.id)}})(e)),class:"popover-list"},ve)])),_:1},8,["placement"])])]),p("div",pe,L(r(o).content),1),p("div",ge,[p("ul",fe,[(t(!0),u(h,null,m(r(o).tags,(e=>(t(),u("li",{key:e.content,onClick:w((t=>{return a=e.content,void s.push({name:"memo",query:{tag:a}});var a}),["prevent"])}," #"+L(e.content),9,he)))),128))])])]))}});me.__scopeId="data-v-4d998c92",x("data-v-171d9a1e");const we={class:"title-wrp"},ye={key:0,style:{display:"inline"}},xe=p("span",{class:"line"},"/",-1),Ce={class:"lastTag"};C();var ke=e({setup(e){const a=S(),s=A((()=>a.query.tag))||n(""),o=n("");H((()=>{o.value=a.query.tag}));const i=b(),c=e=>{i.push({name:"memo",query:e})},[g,h]=z(!1),m=()=>{V(s.value,o.value).then((e=>{T.success("修改成功"),g.value=!1,c({tag:o.value})}))};return(e,a)=>(t(),u("div",we,[p("span",{onClick:a[0]||(a[0]=w((e=>c()),["prevent"])),class:"title"}," MEMO "),r(s)?(t(),u("div",ye,[xe,d(p("input",{type:"text",class:"tagEdit","onUpdate:modelValue":a[1]||(a[1]=e=>o.value=e)},null,512),[[v,o.value],[f,r(g)]]),d(p("b",Ce,[p("span",null,[p("label",null,L(r(s)),1)])],512),[[f,!r(g)]]),d(l(r(N),{class:"icon",onClick:a[2]||(a[2]=w((e=>g.value=!0),["prevent"]))},null,512),[[f,!r(g)]]),d(l(r(Y),{class:"icon",onClick:w(m,["prevent"])},null,8,["onClick"]),[[f,r(g)]])])):I("",!0),l(r(Q),{class:"icon",onClick:a[3]||(a[3]=w((e=>c()),["prevent"]))})]))}});ke.__scopeId="data-v-171d9a1e",x("data-v-c294dd04");const Le={class:"memo-view"},be={class:"input-wrapper"},_e=p("input",{type:"text"},null,-1),Ae={class:"card-container"};C();var Ee=e({setup(e){const n=B(),{articleList:o}=c(n),i=S();return s((()=>i.query),(e=>{const{tag:t}=e;t?n.getArticleList({tag:t}):n.getArticleList()}),{immediate:!0}),(e,n)=>(t(),u("div",Le,[p("nav",null,[l(ke),p("div",be,[_e,p("i",null,[l(r(J))])])]),l(oe),p("ul",Ae,[(t(!0),u(h,null,m(r(o),((e,l)=>(t(),a(me,{key:e.id,article:e,isLast:r(o).length-1===l},null,8,["article","isLast"])))),128))])]))}});Ee.__scopeId="data-v-c294dd04";export{Ee as default};
